import{r as o,j as e,c as h}from"./index.470a316f.js";import{L as E,c as F}from"./style.deb3bbcd.js";import{D as L}from"./dialog.c0dc4f7d.js";import{B as x}from"./button.13964de9.js";function q(w){const{imageURL:k,visible:t,options:g,action:N,fixed:C,fixedNumber:a,circle:v=!1,outputFilename:y="cropper.png",getInstance:p,onCancel:l,onClose:u,onConfirm:m}=w,s=o.exports.useRef(null),i=o.exports.useRef(null),[f,B]=o.exports.useState(),[D,c]=o.exports.useState(t);return o.exports.useLayoutEffect(()=>{if(t&&s.current&&i.current){console.log(g);const n=new E(s.current,{autoCropArea:1,...C?{data:{width:a,height:a},minCropBoxWidth:a,minCropBoxHeight:a,resizeable:!1,cropBoxResizable:!1}:{},...g,preview:i.current});B(n),c(t),p==null||p(n)}},[t,i,s]),e("aside",{className:"otaku-cropper-container",children:h(L,{show:D,title:"\u56FE\u7247\u88C1\u526A",className:"otaku-cropper-dialog",width:"auto",footer:h("div",{className:"otaku-cropper-footer",children:[e(x,{onClick:()=>{c(!1),l==null||l()},children:"\u53D6\u6D88"}),e(x,{type:"primary",onClick:async()=>{const n=()=>new Promise((S,j)=>{const d=f==null?void 0:f.getCroppedCanvas({imageSmoothingQuality:"high"});d==null||d.toBlob(r=>{if(r){const A=new File([r],y,{type:r==null?void 0:r.type});S({blob:r,file:A})}else j(null)})});c(!1);const R=await n();m==null||m(R)},children:"\u786E\u5B9A"})]}),onClose:()=>{c(!1),u==null||u()},children:[e("div",{className:"otaku-image-cropper",children:e("img",{src:k,alt:"",ref:s,className:"otaku-image-cropper-image"})}),e("div",{className:F("otaku-image-cropper-preview-container",{"is-circle":v}),children:e("div",{className:"otaku-image-cropper-preview",ref:i})}),e("section",{className:"otaku-action-container",children:N})]})})}export{q as I};
